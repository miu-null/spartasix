<div id="my-grid">
  <div class="box1"></div>
  <div class="box2"></div>
  <div class="box3">
    <div class="container popular_container">
      <div class="club_table_container">
        <table class="table table-hover club_table">
          <thead id="club_thead">
            <tr>
              <th>ì¸ê¸° ëª¨ì„</th>
              <th></th>
              <th></th>
              <th>ğŸ˜˜</th>
              <th>ğŸ“†</th>
              <th>ğŸ‘€</th>
              <!-- <th></th> -->
            </tr>
          </thead>
          <tbody>
            <% if (sortPosts.length) { %>
              <% const maxViewCount=Math.max(...sortPosts.map(data=> data.viewCount)) %>
                <% sortPosts.forEach(data=> { %>
                  <tr id="club_tr">
                    <% if (data.viewCount===maxViewCount) { %>
                      <td>ğŸ¥‡</td>
                      <% } else { %>
                        <td>ğŸ¥ˆ</td>
                        <% } %>
                          <td>
                            <%= data.category %>
                          </td>
                          <td id="club_Title"><a class="postLink" href='list/<%= data.id%>'>
                              <%= data.title %>
                            </a></td>
                          <td id="club_Writer"><a class="postLink" href="/userpage/<%= data.userId %>">
                              <%= data.user.nickName %>
                            </a></td>
                          <td id="club_Date">
                            <%= reformPostDate(data.createdAt) %>
                          </td>
                          <td id="club_View">
                            <%= data.viewCount %>
                          </td>
                          <!-- <td id="club_Likes">
                          <%# data.Likes %>
                        </td> -->

                          <% }) %>
                            <% } else { %>
                              <td id="club_Likes"> ì¸ê¸°ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</td>
                              <% } %>
                  </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="box4"></div>
  </div>
</div>


<div class="container club_container">
  <div>
    <a style="cursor: pointer" onclick="newPost()" class="new_club">+ new post</a>
  </div>
  <div class="club_table_container">
    <table class="table table-hover club_table">
      <thead id="club_thead">
        <tr>
          <th>Club</th>
          <th>ì¹´í…Œê³ ë¦¬</th>
          <th>ì œëª©</th>
          <th>ì‘ì„±ì</th>
          <th>ì¸ì›êµ¬ì„±</th>
          <th>ì‘ì„±ì¼</th>
          <th>ì¡°íšŒìˆ˜</th>
          <!-- <th>ì¢‹ì•„ìš”</th> -->
        </tr>
      </thead>
      <tbody>
        <% slicedData.forEach(data=> { %>
          <tr id="club_tr">
            <td id="club_Id"><a class="postLink" href='list/<%= data.id%>'>
                <%= data.id %>
              </a></td>
            <td>
              <%= data.category %>
            </td>
            <td id="club_Title"><a class="postLink" href='list/<%= data.id%>'>
                <%= data.title %>
              </a></td>
            <td id="club_Writer"><a class="postLink" href="/userpage/<%= data.userId %>">
                <%= data.user.nickName %>
            </td>

            <td id="club_maxMember">
              <%= data.maxMembers %>
            </td>
            <td id="club_Date">
              <%= reformPostDate(data.createdAt) %>
            </td>
            <td id="club_View">
              <%= data.viewCount %>
            </td>
            <!-- <td id="club_Likes">
              <%# data.Likes %>
            </td> -->
          </tr>
          <% }) %>
      </tbody>
    </table>
  </div>
</div>

<div id="pagination">
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
      <% if (unitStart - 1> 0 ) { %>
        <li class="page-item">
          <a class="page-link" href="?page=<%= unitStart -1 %>" tabindex="-1" aria-disabled="true">ì´ì „</span>
          </a>
        </li>
        <% } %>
          <% for (let i=unitStart; i <=unitEnd; i++) { %>
            <% if (i <=lastPage) { %>
              <% if ( i===page) { %>
                <li class="page-item active" aria-current="page">
                  <span class="page-link">
                    <%= i %>
                  </span>
                </li>
                <% } else { %>
                  <li class="page-item"><a class="page-link" href="?page=<%= i %>">
                      <%= i %>
                    </a></li>
                  <% } %>
                    <% } %>
                      <% } %>
                        <% if (unitEnd < lastPage) { %>
                          <li class="page-item">
                            <a class="page-link" href="?page=<%= unitEnd +1 %>">ë‹¤ìŒ
                            </a>
                          </li>
                          <% } %>
    </ul>
  </nav>
</div>

<section id="search" class="search-wrap" >
  <form action="/club/search" class="search-form">
      <div class="input-group">
        <div class="input-group-append" >
          <select class="form-select" name="searchOption" id="searchOption" >
            <option value="title">ì œëª©</option>
            <option value="titleAndContent" selected>ì œëª©+ë‚´ìš©</option>
          </select>
        </div>
        <input type="search" id="term" name="term" class="form-control" placeholder="ğŸ”ê²€ìƒ‰"
          aria-label="Search">
      </div>
    </div>
  </form>
</section>

<script>
  // ê²€ìƒ‰:ì´ì „ì— ì„ íƒëœ ë“œë¡­ë‹¤ìš´ ì˜µì…˜ì„ ë¶ˆëŸ¬ì˜´
  const selectedOption = localStorage.getItem('selectedOption');
  if (selectedOption) {
    document.getElementById('searchOption').value = selectedOption;
  }
  
  // ê²€ìƒ‰:ë“œë¡­ë‹¤ìš´ ì˜µì…˜ì´ ë³€ê²½ë  ë•Œë§ˆë‹¤ localStorageì— ì €ì¥í•¨
  document.getElementById('searchOption').addEventListener('change', function() {
    localStorage.setItem('selectedOption', this.value);
  });
</script>
